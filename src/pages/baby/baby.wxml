<wxs module="timeUtil" src="./time.wxs"></wxs>
<t-navbar t-class-placeholder="t-navbar-placeholder" t-class-content="t-navbar-content">
  <view slot="capsule" class="custom-capsule">
    <t-icon
      size="40rpx"
      bind:tap="onBack"
      aria-role="button"
      aria-label="返回"
      name="chevron-left"
      class="custom-capsule__icon back"
    />
    <t-icon
      size="40rpx"
      bind:tap="addBaby"
      aria-role="button"
      aria-label="添加宝宝"
      name="add"
      class="custom-capsule__icon home"
    />
  </view>
  <view slot="title" wx:if="{{babyList.length > 0}}">
        <picker range="{{babyList}}" range-key="lovename" bindchange="onBabyChange">
          <view class="flex items-center">
            <text class="text-sm">{{chooseBaby.lovename}}</text>
            <image src="../../assets/images/arrow_down.png" class="w-4 h-4 ml-2"></image>
          </view>
        </picker>
  </view>
</t-navbar>
<view class="container -mt-24">
  <view class="baby-show">
    <view style="height: {{statusBarHeight + 54}}px;"></view>

    <view wx:if="{{babyList.length > 0}}" class="px-4">

      <view class="flex justify-between items-center mt-2 pl-8 text-xs">
        <view>
          <text class="text-yellow-700">{{chooseBaby.field2}}</text>
          <view class="text-sm font-bold my-2 flex items-center">
            <text class="mr-2">{{chooseBaby.lovename}}</text>
            <image src="../../assets/images/edit_icon.png" class="w-6 h-6" bind:tap="setBaby"></image>
          </view>
          <text class="text-yellow-700">身高（长）</text>
          <view class="text-sm font-bold my-2">{{chooseBaby.lastheight}}cm</view>
          <text class="text-yellow-700">体重</text>
          <view class="text-sm font-bold mt-2">{{chooseBaby.lastweight}}kg</view>
        </view>
        <image class="w-36" src="{{chooseBaby.field1 === '男' ? 'http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/baby_boy.png' : 'http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/baby_gril.png'}}" mode="widthFix"></image>
      </view>
    </view>

    <view wx:else class="h-full flex justify-center items-center">
      <view class="text-center">
        <view class="font-semibold mb-4">还未创建宝宝专属档案</view>
        <view class="bg-yellow-600 rounded-full px-6 py-2 inline-flex items-center" bind:tap="addBaby">
          <image src="../../assets/images/plus_icon.png" class="w-5 h-5"></image>
          <text class="text-white ml-2">创建档案</text>
        </view>
      </view>
    </view>
  </view>

  <view class="p-4">
    <view class="bg-white rounded-lg flex justify-around p-4">
      <view class="text-center" bind:tap="page_to" data-url="/pages/baby/feeding">
        <image class="w-12 h-12" src="http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/icon_wygl.png"></image>
        <text class="block text-sm mt-2">喂养攻略</text>
      </view>
      <view class="text-center" bind:tap="page_to" data-url="/pages/baby/vac_date/vac_date">
        <image class="w-12 h-12" src="http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/icon_ymzq.png"></image>
        <text class="block text-sm mt-2">疫苗周期</text>
      </view>
      <view class="text-center" bind:tap="page_to" data-url="/pages/baby/devlopGud">
        <image class="w-12 h-12" src="http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/icon_fyzn.png"></image>
        <text class="block text-sm mt-2">发育指南</text>
      </view>
      <view class="text-center" bind:tap="page_to" data-url="/pages/baby/sleepMemo">
        <image class="w-12 h-12" src="http://braha.oss-cn-beijing.aliyuncs.com/app_info/images/baby/icon_smzd.png"></image>
        <text class="block text-sm mt-2">睡眠指导</text>
      </view>
    </view>
  </view>

  <view wx:if="{{memoList.length > 0}}" class="px-4">
    <text class="text-lg font-bold border-b-2 border-yellow-500 pb-1">宝宝记录</text>
    <block wx:for="{{memoList}}" wx:key="id">
      <view class="mt-6">
        <text class="font-bold text-lg">{{timeUtil.format(item.createtime, 'dd')}}</text>
        <text class="text-xs text-gray-500 ml-2">{{timeUtil.format(item.createtime, '/MM月 yyyy年')}}</text>
        <text class="text-xs text-white rounded-tr-lg rounded-bl-lg px-2 py-1 ml-2 {{item.field1 === '大事记' ? 'bg-orange-500' : 'bg-yellow-600'}}">{{item.field1}}</text>

        <view class="bg-white rounded-lg mt-3 p-4">

          <view class="mt-3">
            <view wx:if="{{item.field1 === '大事记' || item.field1 === '随手记' || item.field1 === '换尿布'}}" class="{{item.field1 === '大事记' ? 'text-yellow-700 font-semibold' : ''}}">{{item.describe}}</view>
            <view wx:else>
              <view class="text-yellow-700 font-semibold">{{item.field1}} | {{item.field2}} {{timeUtil.getUnit(item.field1)}}</view>
              <view class="mt-2">{{item.describe}}</view>
            </view>
          </view>

          <view class="flex mt-3">
            <block wx:for="{{item.imgList}}" wx:for-item="img" wx:key="*this">
              <image class="w-24 h-24 mr-2 rounded" src="{{img}}" mode="aspectFill" bind:tap="showImg" data-url="{{img}}"></image>
            </block>
          </view>

          <view class="flex justify-between items-center mt-3 text-xs">
            <view class="text-yellow-700">
              <text>{{item.nickName}}</text>
              <text class="ml-4">{{timeUtil.format(item.createtime, 'hh:mm')}}发布</text>
            </view>
            <view class="flex items-center text-gray-500" bind:tap="show_del" data-item="{{item}}">
              <image src="../../assets/images/delete_icon.png" class="w-4 h-4"></image>
              <text class="ml-1">删除</text>
            </view>
          </view>
        </view>
      </view>
    </block>
  </view>

  <view wx:if="{{babyList.length > 0}}" class="fixed w-14 h-14 bg-yellow-600 rounded-full flex justify-center items-center bottom-20 right-8 shadow-lg" bind:tap="showDayPopup">
    <image src="../../assets/images/plus_icon.png" class="w-8 h-8"></image>
  </view>

  <view wx:if="{{dayShow}}" class="fixed inset-0 bg-black bg-opacity-50 z-40" bind:tap="hideDayPopup">
    <view class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl p-4 text-center" catch:tap>
      <view class="grid grid-cols-4 gap-y-4 border-b pb-4">
        <view bind:tap="baby_day" data-name="随手记">
          <view class="icon_bg bg-yellow-100"><image class="w-8 h-8" src="../../assets/images/memo_icon.png"></image></view>
          <text class="text-xs mt-2 block">随手记</text>
        </view>
        <view bind:tap="baby_day" data-name="大事记">
          <view class="icon_bg bg-yellow-100"><image class="w-8 h-8" src="../../assets/images/event_icon.png"></image></view>
          <text class="text-xs mt-2 block">大事记</text>
        </view>
        <block wx:for="{{icon_list}}" wx:key="name">
          <view bind:tap="baby_day" data-name="{{item.name}}">
            <view class="icon_bg" style="background-color:{{item.bgColor}}"><image class="w-8 h-8" src="{{item.imgurl}}"></image></view>
            <text class="text-xs mt-2 block">{{item.name}}</text>
          </view>
        </block>
      </view>
      <view class="py-3" bind:tap="hideDayPopup">取消</view>
    </view>
  </view>
</view>